describe('Testes do Fórum', () => {
    const filterResponse = {
        "content": [
            {
                "id": "65e35c58-f0a9-4315-9860-472ecdcc2ece",
                "title": "Problema com loop em Java",
                "description": "Estou enfrentando um loop infinito em Java. Alguém pode ajudar?",
                "codeSnippet": "while(true) { System.out.println('Infinite loop'); }",
                "status": "OPEN",
                "creationDate": "2024-11-23T21:14:50.482+00:00",
                "editDate": null,
                "voteCount": 0,
                "userName": "miguel",
                "userId": "b857e014-c03e-4683-b32a-17211411eee0",
                "comments": [],
                "tags": [
                    {
                        "id": "11bfdd9a-ae2a-4ce9-9632-ffdfb2de2400",
                        "name": "Java Programming"
                    }
                ]
            },
            {
                "id": "9f7a5afd-4d95-49c5-beea-a3b395422759",
                "title": "Problema com loop em Java",
                "description": "Estou enfrentando um loop infinito em Java. Alguém pode ajudar?",
                "codeSnippet": "while(true) { System.out.println('Infinite loop'); }",
                "status": "OPEN",
                "creationDate": "2024-11-23T21:14:53.749+00:00",
                "editDate": null,
                "voteCount": 0,
                "userName": "miguel",
                "userId": "b857e014-c03e-4683-b32a-17211411eee0",
                "comments": [],
                "tags": [
                    {
                        "id": "11bfdd9a-ae2a-4ce9-9632-ffdfb2de2400",
                        "name": "Java Programming"
                    }
                ]
            },
            {
                "id": "7bbebfbc-247e-4bd1-9cae-70b3772040ac",
                "title": "string",
                "description": "string",
                "codeSnippet": "string",
                "status": "OPEN",
                "creationDate": "2024-11-23T21:14:46.950+00:00",
                "editDate": "2024-11-23T21:25:05.624+00:00",
                "voteCount": 0,
                "userName": "miguel",
                "userId": "b857e014-c03e-4683-b32a-17211411eee0",
                "comments": [
                    {
                        "id": "a8938e7b-efb9-47ef-9108-2fb172710e19",
                        "content": "rety54y",
                        "codeSnippet": "64y765756",
                        "userName": "maria",
                        "userId": "845a6d46-d06f-48ae-a888-5181c5eaee4a"
                    }
                ],
                "tags": [
                    {
                        "id": "11bfdd9a-ae2a-4ce9-9632-ffdfb2de2400",
                        "name": "Java Programming"
                    }
                ]
            },
            {
                "id": "f889d411-5ec3-4b89-9f88-5607f48603c2",
                "title": "er",
                "description": "wr",
                "codeSnippet": "werwe",
                "status": "OPEN",
                "creationDate": "2024-11-24T00:34:08.526+00:00",
                "editDate": null,
                "voteCount": 0,
                "userName": "maria",
                "userId": "845a6d46-d06f-48ae-a888-5181c5eaee4a",
                "comments": [],
                "tags": [
                    {
                        "id": "dee65cdf-e60a-408d-bf0d-d62f7a02f661",
                        "name": "arduino"
                    },
                    {
                        "id": "1f7b823f-e859-4a0e-8213-361c2b0102a5",
                        "name": "er"
                    }
                ]
            },
            {
                "id": "70c81596-508c-48ce-be0e-470783f3814b",
                "title": "Oi",
                "description": "sdfd",
                "codeSnippet": "fd",
                "status": "OPEN",
                "creationDate": "2024-11-24T00:34:29.325+00:00",
                "editDate": null,
                "voteCount": 0,
                "userName": "maria",
                "userId": "845a6d46-d06f-48ae-a888-5181c5eaee4a",
                "comments": [],
                "tags": [
                    {
                        "id": "11bfdd9a-ae2a-4ce9-9632-ffdfb2de2400",
                        "name": "Java Programming"
                    }
                ]
            },
            {
                "id": "8808a57b-886e-40e1-a8c6-3d2d2ea84aa3",
                "title": "arduino falhando",
                "description": "sdfsdf",
                "codeSnippet": "   <Option value=\"title\">Título</Option>\n          <Option value=\"description\">Descrição</Option>\n          <Option value=\"codeSnippet\">Código</Option>\n          <Option value=\"status\">Status</Option>\n          <Option value=\"voteCount\">Votos</Option>\n          <Option value=\"userName\">Usuário</Option>",
                "status": "OPEN",
                "creationDate": "2024-11-24T00:40:45.609+00:00",
                "editDate": null,
                "voteCount": 0,
                "userName": "maria",
                "userId": "845a6d46-d06f-48ae-a888-5181c5eaee4a",
                "comments": [
                    {
                        "id": "bfff0709-7945-41d1-9c84-372a7ce8da89",
                        "content": "etr4t",
                        "codeSnippet": "wrtret",
                        "userName": "maria",
                        "userId": "845a6d46-d06f-48ae-a888-5181c5eaee4a"
                    }
                ],
                "tags": [
                    {
                        "id": "11bfdd9a-ae2a-4ce9-9632-ffdfb2de2400",
                        "name": "Java Programming"
                    },
                    {
                        "id": "322cceff-5fb4-47dc-bf28-7e6434d1baa7",
                        "name": "arduinoteste"
                    }
                ]
            }
        ],
        "pageable": {
            "pageNumber": 0,
            "pageSize": 10,
            "sort": {
                "empty": true,
                "sorted": false,
                "unsorted": true
            },
            "offset": 0,
            "unpaged": false,
            "paged": true
        },
        "totalElements": 6,
        "totalPages": 1,
        "last": true,
        "size": 10,
        "number": 0,
        "sort": {
            "empty": true,
            "sorted": false,
            "unsorted": true
        },
        "numberOfElements": 6,
        "first": true,
        "empty": false
    };

    const tagsResponde = [
        {
            "id": "dee65cdf-e60a-408d-bf0d-d62f7a02f661",
            "name": "arduino"
        },
        {
            "id": "11bfdd9a-ae2a-4ce9-9632-ffdfb2de2400",
            "name": "Java Programming"
        },
        {
            "id": "b1bb0472-8f97-4ec3-a9ad-60a39a551f0c",
            "name": "gggg"
        },
        {
            "id": "ae521403-aefe-4262-b2a0-cdad66e5ad7b",
            "name": "text"
        },
        {
            "id": "597c9057-78da-4af8-a8cf-9aef08df4f89",
            "name": "tytr"
        },
        {
            "id": "24cadded-5df9-4008-bd44-6b1475de8c37",
            "name": "dfdg"
        },
        {
            "id": "4a6f7368-4e9b-4c82-bc68-e9db8485ed6f",
            "name": "tag"
        },
        {
            "id": "1f7b823f-e859-4a0e-8213-361c2b0102a5",
            "name": "er"
        },
        {
            "id": "322cceff-5fb4-47dc-bf28-7e6434d1baa7",
            "name": "arduinoteste"
        }
    ]

    const commentsResponde = {
        "id": "65e35c58-f0a9-4315-9860-472ecdcc2ece",
        "title": "Problema com loop em Java",
        "description": "Estou enfrentando um loop infinito em Java. Alguém pode ajudar?",
        "codeSnippet": "while(true) { System.out.println('Infinite loop'); }",
        "status": "OPEN",
        "creationDate": "2024-11-23T21:14:50.482+00:00",
        "editDate": null,
        "voteCount": 0,
        "userName": "miguel",
        "userId": "b857e014-c03e-4683-b32a-17211411eee0",
        "comments": [],
        "tags": [
            {
                "id": "11bfdd9a-ae2a-4ce9-9632-ffdfb2de2400",
                "name": "Java Programming"
            }
        ]
    };

    beforeEach(() => {
        cy.loginEstudante();
        cy.visit('/student');
        cy.get('span.ant-menu-title-content')
            .contains('Fórum')
            .click();

        cy.intercept('POST', 'http://4.196.97.77:9002/api/v1/forum/filter?page=0&size=10', {
            statusCode: 200,
            body: filterResponse
        }).as('getFilter');

        cy.intercept('GET', 'http://4.196.97.77:9002/api/v1/forum/tags', {
            statusCode: 200,
            body: tagsResponde
        }).as('getTags');

        cy.intercept('GET', 'http://4.196.97.77:9002/api/v1/forum/65e35c58-f0a9-4315-9860-472ecdcc2ece', {
            statusCode: 200,
            body: commentsResponde
        }).as('getComments');
    });

    it('Listar informações básicas do Fórum2', () => {
        cy.wait('@getFilter').its('response.statusCode').should('eq', 200);
        cy.wait('@getTags').its('response.statusCode').should('eq', 200);

        cy.get('h4').contains('Bem-vindo ao Fórum do Laboratório');
        cy.get('.ant-col-20 > p').contains('Aqui no Fórum, você pode explorar problemas, dúvidas e discussões relacionadas aos nossos projetos e componentes. Este é um espaço colaborativo e exclusivo para os membros do nosso sistema.');

        cy.get('.ant-col-20 > p').should('exist');
    });

    it('Listar tópicos do Fórum', () => {
        cy.get('span.ant-menu-title-content')
            .contains('Biblioteca')
            .click();

        cy.get('span.ant-menu-title-content')
            .contains('Fórum')
            .click();

        cy.wait('@getFilter').its('response.statusCode').should('eq', 200);
        cy.wait('@getTags').its('response.statusCode').should('eq', 200);

        cy.get('.ant-list-items > :nth-child(1) > .ant-card-body > .ant-row-start > :nth-child(1) > p').contains('Problema com loop em Java');
        cy.get(':nth-child(1) > .ant-card-body > .ant-row-start > :nth-child(2) > p').contains('Estou enfrentando um loop infinito em Java. Alguém pode ajudar?');
        cy.get(':nth-child(1) > .ant-card-body > .ant-row-start > :nth-child(3) > p').contains('miguel');
        cy.get(':nth-child(1) > .ant-card-body > .ant-row-start > :nth-child(4) > p').contains('23/11/2024');
    });

    it('Listar e adicionar comentários ao tópico', () => {
        cy.get('span.ant-menu-title-content')
            .contains('Biblioteca')
            .click();

        cy.get('span.ant-menu-title-content')
            .contains('Fórum')
            .click();

        cy.wait('@getFilter').its('response.statusCode').should('eq', 200);
        cy.wait('@getTags').its('response.statusCode').should('eq', 200);

        cy.get(':nth-child(1) > .ant-card-body > .ant-row-end > .ant-btn').click();
        cy.wait('@getComments').its('response.statusCode').should('eq', 200);

        cy.get('ol').should('contain.text', 'Home/student/Fórum/65e35c58-f0a9-4315-9860-472ecdcc2ece');

        cy.get('[style="margin-top: 20px;"] > .ant-btn').click();
        cy.get('.ant-message-notice-content').contains('O comentário não pode estar vazio.')

        cy.get('[placeholder="Escreva seu comentário aqui..."]').should('be.empty');
        cy.get('[placeholder="Escreva seu comentário aqui..."]').type('Comentário Teste');
        cy.get('[placeholder="Escreva seu comentário aqui..."]').contains('Comentário Teste');

        cy.get('[placeholder="Trecho de código (opcional)"]').type('Códico Teste');
    });
})